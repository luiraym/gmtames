<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Applicability Domain toolbox for MATLAB</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="generator" content="HAPedit 3.0">

<link href = "style_structure.css" rel="stylesheet" type="text/css">
<link href = "style_text.css" rel="stylesheet" type="text/css">
<link href = "style_tables.css" rel="stylesheet" type="text/css">

<style type="text/css">
<!--
.style1 {
	color: #FF0000;
	font-weight: bold;
}
-->
</style>
</head>
<body>
<div id="container">
<a name="top"></a>

    <div id="header">
		<iframe src="header.htm" width="740" height="60" scrolling="no" frameborder="0">
  			no i_frames allowed :: change browser
	  	</iframe>
    </div>

    <div id="content">

		<table width="740" border="0" cellpadding="0" cellspacing="0">
  		<tr>
		<td width="150" valign="top">
		
		<iframe src="menu_lateral.htm" width="135" height="320" scrolling="no" frameborder="0">
  			no i_frames allowed :: change browser
	  	</iframe>
		
		</td>

    	<td valign="top">

		  <div align="justify">
		    <div id="tab_duo_contenitor" class="text">
		    <span class="title_page">Example</span>		
		    <BR>
		    <BR>
    
		<div id="tab_duo_text">
			  <div id="tab_space_lateral"><a href="#sub_0" class="lnk_text">Illustrative  dataset </a></div>
			  <div id="tab_space_lateral"><a href="#sub_0bis" class="lnk_text">Working with the graphical interface</a></div>
		      <div id="tab_space_lateral"><a href="#sub_1" class="lnk_text">Working with the command line</a></div>
	   	</div>
    <BR><a name="sub_0" id="sub_0"></a>
		    <BR>
		    
		<span class="title_paragraph"> Illustrative dataset</span>
		    <BR>
		    <BR>
		    This example of application of the Applicability Domain toolbox is based on a illuistrative dataset composed by 4 variables, 408 training samples and 57 test samples. Experimental and calculated responsens for both training and test samples are available.  The  dataset is provided togheter with the toolbox. It can be opened by typing:<br>
            <br>
            <div id="tab_duo_text" class="text_math"> load example_data </div>
            <br>
on the MATLAB command window.<BR>
			  <BR>
			  [<a href="#top" class="lnk_text">-> top</a>]<BR>
		      <BR>
		      <a name="sub_0bis" id="sub_0"></a>
		      <BR>
		    
		      <span class="title_paragraph">Working with the graphical interface</span><BR>
		      <BR>
		    Once data have been loaded in the MATLAB workspace, you can open the graphical interface by typing the following code in the MATLAB command window: <BR>
            <BR>
            </p>
            <div id="tab_duo_text" class="text_math"> ad_gui</div>
            <BR> 
            In order to calculate AD methods, we have to load training and test data in the GUI. In order to do that, we can proceed in the following way: select &quot;load training set&quot; in the file menu.
            We can select the X matlab variable (the training set) and click load. The listbox of the toolbox main form will be updated with the data details (number of training samples, number of variables). Then we can follow the same procedure for loading the test set, by clicking &quot;load test set&quot; in the file menu and choosing Xtest. <BR>
			<center>
              <img src="example_01.gif" width="450" height="293">            </center>
			<BR>
			We can now proceed in the AD calculation. By clicking &quot;calculate-&gt;applicability domain&quot;, the <a href="gui_calculate.htm" class="lnk_text">settings</a> form will appear. We can choose to calculate all available AD methods with the standard settings, as shown in the following figure.<BR><BR>
			<center>
              <img src="gui_2.gif" width="502" height="638">            </center>
			<BR>
			Once the AD methods have been calculated, the model window in the main form is updated with an overview of the AD results. We can see details on the results achieved oin the test set by clicking &quot;results-&gt;test set results&quot;. The following table will appear in the MATLAB variable viewer:<BR><BR>
			<center><img src="example_02.gif" width="395" height="260"></center><BR>
			For each calculated AD method, options used to calculate the AD method, number of test samples inside the AD, number of test samples outside the AD and a list of test samples outside the AD is shown.<BR>
			A consensus analysis of all AD methods can be performed by selecting &quot;results-&gt;view consensus&quot;. A figure will appear with frequencies of test samples placed out of the AD by the calculated methods. In this example, test sample with id 28 was excluded from the model AD by 7 methods, while samples 3 and 44 were excluded by 5 methods. <BR>
            <BR>
            <center><img src="example_03.gif" width="515" height="404"></center><BR>
            We can then analyse the william plot (levergaes versus standardised residuals) by selecting &quot;results-&gt;view William plot&quot;. A new form will appear; here it is possible to load experimental and calculated responses for both training and test sets from the MATLAB workspace (Y_exp, Y_calc, Ytest_exp and Ytest_calc). <BR>
            <BR>
            <center><img src="example_04.gif" width="507" height="350"></center><BR>
            Training samples are marked in black, test samples in red. Red lines indicate warning thresholds for standardised residuals (-2 and +2) and the leverages threshold. All test samples with leverage values higher than this threshold are excluded from the model AD. Labels can be added to the plot in order to identify test samples. <BR>
            Finally, results related to the automatic selection of the best k value for the kNN with variable k method (see details in <a href="gui_calculate.htm" class="lnk_text">this section</a>) can be analysed by clicking &quot;results-&gt;view k results&quot;. The following box-and-whisker plot will appear. Note that the optimisation procedure is based on a montecarlo approach, therefore results can be slighlty different everytime the procedure is run. <BR><BR>
            <center><img src="example_05.gif" width="527" height="353"></center><BR>
            In this figure, the distribution of test samples (%) retained within the AD for different k values during the montecarlo procedure is shown. The first lower k values are associated
            with box plots having highest spread. This degree of dispersion 
            lowered gradually with increase in number of
            neighbours considered. The line plot of the mean showes
            an increase in the number of samples throughout the plot.
            Based on their lower spread and preference to retain reasonably
            higher number of samples within the AD,  k values associated to small dispersion can be considered further to decide upon an optimal
            k. Details on this plot are given in the following paper: F. Sahigara, D. Ballabio, R. Todeschini, V. Consonni, Defining a novel k-Nearest Neighbours approach to assess the applicability domain of a QSAR model for reliable predictions, <em>Journal of Cheminformatics</em> (<strong>2013</strong>), 5:27, 1-9.<BR>
            Finally, achieved results, togheter with   settings and outputs of all calculated AD methods, can be saved in the MATLAB workspace by clicking &quot;file-&gt;save ad results&quot;. For further information on the structure of AD results  look the help provided in the <a href="routines.htm" class="lnk_text">ad_model matlab m file</a>. However, consider that a binary vector defining which test samples are inside (1) or outside (0) the AD defined by means of each AD method is provided in the result structure.<BR>
            Moreover, a resume of the results achieved on the test set can be exported as excel file ("file-&gt;export test results"). An excel file will be saved in the folder where the toolbox is placed, with the following informations for each calculated AD method: options used to calculate the AD method, number of test samples inside the AD, number of test samples outside the AD, list of test samples outside the AD.<BR>
  <BR>[<a href="#top" class="lnk_text">-> top</a>]<BR>
		    <BR><a name="sub_1" id="sub_0"></a>
		    <BR>
		    
		<span class="title_paragraph">Working with the command line</span><BR>
		    <BR>
			All calculations done with the GUI can be also run directly in the MATLAB command window. Type:<BR>
		    <BR>
			
			<div id="tab_duo_text" class="text_math">
		      load example_data </div>
			<BR>

		    in the MATLAB command window to load the data.			Then, we can define the settings for all the AD methods:
			<BR>
		    <BR>
			
			<div id="tab_duo_text" class="text_math">
		    options.pret_type = 'auto';
<BR>options.distance = 'euclidean';
<BR>options.lev_thr = 2.5000;
<BR>options.knnfix_k = 5;
<BR>options.dist_pct = 95;
<BR>options.knnvar_k_max = 25;
<BR>options.knnvar_k_opt = 'auto';
<BR>options.knnvar_iter = 1000;
<BR>options.knnvar_perc_test = 0.8000;
<BR>options.pf_pct = 95;
<BR>options.pf_kernel = 'gaus';
<BR>options.pf_smoot = [0.8000 1.2000];  
			  </div>
			<BR>  
			For further information on the settings of AD results  look the help provided in the <a href="routines.htm" class="lnk_text">ad_model matlab m file </a>or <a href="gui_calculate.htm" class="lnk_text">this help section</a>. Then, we can start the AD calculation by typing:<BR>
            <BR>
            <div id="tab_duo_text" class="text_math"> res=ad_model(X,Xtest,options);</div>
            <BR>
on the MATLAB command window. Calculation will start and a resume of the status of the calcuations and
 optimisation procedures (if any) will appear on the MATLAB command 
window. The res structure contain results for each AD method. For further information on the structure of AD results  look the help provided in the <a href="routines.htm" class="lnk_text">ad_model matlab m file</a>. However, consider that a binary vector defining which test samples are inside (1) or outside (0) the AD defined by means of each AD method is provided in the result structure.<BR>

		    <BR>
			[<a href="#top" class="lnk_text">-> top</a>]
			<BR>
			<BR>
			<BR>&nbsp;  	     
		 </div>
  
		  </div></td>
  		</tr>
	  </table>

    </div>

    <div id="footer">
		<iframe src="footer.htm" width="700" height="13" scrolling="no" frameborder="0">
  			no i_frames allowed :: change browser
	  	</iframe>
	</div>
</div>
</body>
</html>